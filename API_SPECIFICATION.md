## Phish Removal Service API Specification

### Base URL: 

`http://api.your-service.com`

### Authentication:

All APIs except for internal ones require authentication via API key, which should be provided in the `Authorization` header in the following format: `Bearer your_api_key`.

### Endpoints:

#### 1. Submit Phishing Report

- Endpoint: `/submitPhishReport`
- Method: `POST`
- Authentication: Required
- Parameters (JSON body):
  - `reportId` (string): A unique identifier for the report.
  - `phishURL` (string): The URL of the phishing website.
  - `timestamp` (string, ISO 8601 datetime format): The timestamp of when the phish was detected.
  - `reviewType` (string): The type of the review done on the page. Possible values are `human` and `automated`.
  - `screenshot` (string, Base64 encoded PNG image, optional): A screenshot of the phishing website.
  - `matchText` (string, optional): Text that matches part of the content on the page.
  - `matchRegex` (string, optional): Regex that would match part of the content on the page.
  - `callbackURL` (string, optional): A URL that the service will call back when the phish report has been processed. The callback will include the following parameters: `reportId`, `status`, `processingTimestamp`.
- Response: JSON object with `reportId`.

#### 2. Check Status

- Endpoint: `/checkStatus`
- Method: `GET`
- Authentication: Required
- Parameters (query string):
  - `reportId` (string): The unique identifier of the report.
- Response: JSON object with `reportId`, `status`, `submissionTimestamp`, `processingTimestamp`. The `status` field can have the following values: `new`, `processed`, `not_applicable`, `not_found`.

#### 3. Unprocessed Reports (Internal)

- Endpoint: `/unprocessedReports`
- Method: `GET`
- Authentication: Not required, only accessible from certain IPs
- Response: JSON array of unprocessed report objects.

#### 4. Update Report Status (Internal)

- Endpoint: `/updateReport/{reportId}`
- Method: `PATCH`
- Authentication: Not required, only accessible from certain IPs
- Parameters (JSON body):
  - `status` (string): The new status of the report. Possible values are `new`, `processed`, `not_applicable`, `not_found`.
  - `processor` (string): The name of the person who processed the report.
- Response: JSON object with `reportId`, `status`.

The status change timestamp (`processingTimestamp`) will be generated by the server at the time of the status change.
